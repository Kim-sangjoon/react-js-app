<?xml version="1.0" encoding="UTF-8"?>
<html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ev="http://www.w3.org/2001/xml-events"
    xmlns:w2="http://www.inswave.com/websquare" xmlns:xf="http://www.w3.org/2002/xforms">
    <head meta_programName="멀티아이템 udc">
    	<w2:type>UDC</w2:type>
        <w2:buildDate/>
        <w2:model></w2:model>
    </head>
    <body>
    	<!--/** WEBSQUARE UDC */
    		{
    		"disableIcon": "",
    		"notSupportBrowser": "",
    		"htmlRender": "",
    		"icon": "",
    		"description": "",
    		"version": "",
    		"apis": [],
    		"pluginName": "udc_multiItem",
    		"width": "",
    		"company": "",
    		"developer": "",
    		"componentName": "udc_multiItem",
    		"category": "Basic",
    		"properties": [
    		{
    		"default": "",
    		"necessary": "Y",
    		"hidden": "N",
    		"name": "id",
    		"description": "Component id",
    		"type": "string",
    		"bindparent": "",
    		"option": ""
    		},
    		{
    		"default": "",
    		"necessary": "N",
    		"hidden": "N",
    		"name": "style",
    		"description": "Component style",
    		"type": "string",
    		"bindparent": "",
    		"option": ""
    		},
    		{
    		"default": "",
    		"necessary": "N",
    		"hidden": "N",
    		"name": "class",
    		"description": "Component class",
    		"type": "string",
    		"bindparent": "",
    		"option": ""
    		},
    		{
    		"default": "",
    		"necessary": "N",
    		"hidden": "N",
    		"name": "labelColId",
    		"description": "desc",
    		"type": "string",
    		"bindparent": "",
    		"option": ""
    		},
    		{
    		"default": "",
    		"necessary": "N",
    		"hidden": "N",
    		"name": "valueColId",
    		"description": "desc",
    		"type": "string",
    		"bindparent": "",
    		"option": ""
    		}
    		],
    		"events": [{
    		"name": "ondeleteItem(info)",
    		"description": "desc",
    		"type": "user"
    		}],
    		"height": ""
    		}
    	-->
    	<xf:group id="" pluginName="udc_multiItem">
    		<link rel="stylesheet" type="text/css" href=""></link>
    		<style type="text/css"><![CDATA[ ]]></style>
    		<script type="text/javascript" src=""></script>
    		<script ev:event="oncreated(options)" type="text/javascript"><![CDATA[
				/**
				 * //property handling
				 * $w.log("id:" + options.id);
				 * $w.log("style:" + options.style);
				 * $w.log("class:" + options.class);
				 * $w.log("labelColId:" + options.labelColId);
				 * $w.log("valueColId:" + options.valueColId);
				 *
				 * //event trigger
				 * udc_obj.trigger("ondeleteItem", [info]);
				*/

				/**
				 * //property handling
				 * $w.log("id:" + options.id);
				 * $w.log("style:" + options.style);
				 * $w.log("class:" + options.class);
				 * $w.log("labelColId:" + options.labelColId);
				 * $w.log("valueColId:" + options.valueColId);
				 *
				 * //event trigger
				 * udc_obj.trigger("ondeleteItem", [info]);
				*/

				/**
				 * //property handling
				 * $w.log("id:" + options.id);
				 * $w.log("style:" + options.style);
				 * $w.log("class:" + options.class);
				 * $w.log("labelColId:" + options.labelColId);
				 * $w.log("valueColId:" + options.valueColId);
				 *
				 * //event trigger
				 * udc_obj.trigger("ondeleteItem", [info]);
				*/

				/**
				 * //property handling
				 * $w.log("id:" + options.id);
				 * $w.log("style:" + options.style);
				 * $w.log("class:" + options.class);
				 * $w.log("labelColId:" + options.labelColId);
				 * $w.log("valueColId:" + options.valueColId);
				 *
				 * //event trigger
				 * udc_obj.trigger("ondeleteItem", [info]);
				*/

				/**
				 * //property handling
				 * $w.log("id:" + options.id);
				 * $w.log("style:" + options.style);
				 * $w.log("class:" + options.class);
				 * $w.log("labelColId:" + options.labelColId);
				 * $w.log("valueColId:" + options.valueColId);
				 *
				 * //event trigger
				*/

				/**
				 * //property handling
				 * $w.log("id:" + options.id);
				 * $w.log("style:" + options.style);
				 * $w.log("class:" + options.class);
				 * $w.log("labelColId:" + options.labelColId);
				 * $w.log("valueColId:" + options.valueColId);
				 *
				 * //event trigger
				*/

				/**
				 * //property handling
				 * $w.log("id:" + options.id);
				 * $w.log("style:" + options.style);
				 * $w.log("class:" + options.class);
				 * $w.log("labelColId:" + options.labelColId);
				 * $w.log("valueColId:" + options.valueColId);
				 *
				 * //event trigger
				*/

				/**
				 * //property handling
				 * $w.log("id:" + options.id);
				 * $w.log("style:" + options.style);
				 * $w.log("class:" + options.class);
				 * $w.log("bindItemSet:" + options.bindItemSet);
				 * $w.log("bindItemSetLabel:" + options.bindItemSetLabel);
				 * $w.log("bindItemSetValue:" + options.bindItemSetValue);
				 *
				 * //event trigger
				*/

				/**
				 * //property handling
				 * $w.log("id:" + options.id);
				 * $w.log("style:" + options.style);
				 * $w.log("class:" + options.class);
				 * $w.log("bindItemSet:" + options.bindItemSet);
				 * $w.log("bindItemSetLabel:" + options.bindItemSetLabel);
				 * $w.log("bindItemSetValue:" + options.bindItemSetValue);
				 *
				 * //event trigger
				*/

				/**
				 * //property handling
				 * $w.log("id:" + options.id);
				 * $w.log("style:" + options.style);
				 * $w.log("class:" + options.class);
				 * $w.log("bindItemSet:" + options.bindItemSet);
				 * $w.log("bindItemSetLabel:" + options.bindItemSetLabel);
				 * $w.log("bindItemSetValue:" + options.bindItemSetValue);
				 *
				 * //event trigger
				*/

				/**
				 * //property handling
				 * $w.log("id:" + options.id);
				 * $w.log("style:" + options.style);
				 * $w.log("class:" + options.class);
				 * $w.log("bindItemSet:" + options.bindItemSet);
				 * $w.log("bindItemSetLabel:" + options.bindItemSetLabel);
				 * $w.log("bindItemSetValue:" + options.bindItemSetValue);
				 *
				 * //event trigger
				*/

				/**
				 * //property handling
				 * $w.log("id:" + options.id);
				 * $w.log("style:" + options.style);
				 * $w.log("class:" + options.class);
				 * $w.log("bindItemSet:" + options.bindItemSet);
				 * $w.log("bindItemSetLabel:" + options.bindItemSetLabel);
				 * $w.log("bindItemSetValue:" + options.bindItemSetValue);
				 *
				 * //event trigger
				*/

				/**
				 * //property handling
				 * $w.log("id:" + options.id);
				 * $w.log("style:" + options.style);
				 * $w.log("class:" + options.class);
				 * $w.log("bindItemSet:" + options.bindItemSet);
				 * $w.log("bindItemSetLabel:" + options.bindItemSetLabel);
				 * $w.log("bindItemSetValue:" + options.bindItemSetValue);
				 *
				 * //event trigger
				*/

				/**
				 * //property handling
				 * $w.log("id:" + options.id);
				 * $w.log("style:" + options.style);
				 * $w.log("class:" + options.class);
				 * $w.log("bindItemSet:" + options.bindItemSet);
				 * $w.log("bindItemLabel:" + options.bindItemLabel);
				 * $w.log("bindItemValue:" + options.bindItemValue);
				 *
				 * //event trigger
				*/

				/**
				 * //property handling
				 * $w.log("id:" + options.id);
				 * $w.log("style:" + options.style);
				 * $w.log("class:" + options.class);
				 * $w.log("bindItemSet:" + options.bindItemSet);
				 * $w.log("bindItemLabel:" + options.bindItemLabel);
				 * $w.log("bindItemValue:" + options.bindItemValue);
				 *
				 * //event trigger
				*/

				/**
				 * //property handling
				 * $w.log("id:" + options.id);
				 * $w.log("style:" + options.style);
				 * $w.log("class:" + options.class);
				 * $w.log("bindItemSet:" + options.bindItemSet);
				 * $w.log("id_5:" + options.id_5);
				 * $w.log("id_6:" + options.id_6);
				 *
				 * //event trigger
				*/

				/**
				 * //property handling
				 * $w.log("id:" + options.id);
				 * $w.log("style:" + options.style);
				 * $w.log("class:" + options.class);
				 * $w.log("ref:" + options.ref);
				 *
				 * //event trigger
				*/

				/**
				 * //property handling
				 * $w.log("id:" + options.id);
				 * $w.log("style:" + options.style);
				 * $w.log("class:" + options.class);
				 * $w.log("ref:" + options.ref);
				 *
				 * //event trigger
				*/

				//var dataListId =  options.bindItemSet;
				var labelColId =  options.labelColId;
				var valueColId =  options.valueColId;
				var valueColList  = [];

//				var scopeFrame = $p.getFrame();
//				if (dataListId.indexOf("data:") > -1) {
//			 	    var dataListId = dataListId.split(".");
//          				var dataOrgId = dataListId[0].replace(/^data:/, "");
//          				var dataObj = scopeFrame.getObj(dataOrgId);
//		        }
//
				var drawData = [];
				var returnData = [];
				var returnValueColData =[];
				udc_obj.drawList = function(){
					gen_list.removeAll();
					var cnt = drawData.length;
					var insertIdx =0;
					returnData = [];
					returnValueColData =[];
					for (var idx = 0; idx < cnt; idx++) {
						if(typeof drawData[idx][labelColId] ==="undefined" || typeof drawData[idx][valueColId] ==="undefined" ){
							udc_obj.deleteAllItem();
							break;
						}

						if(valueColList.indexOf(drawData[idx][valueColId]) >-1){
							continue;
						}
						gen_list.insertChild( insertIdx );
						var grp_listBox = gen_list.getChild( insertIdx , "grp_listBox" );
						var tbx_label = gen_list.getChild( insertIdx , "tbx_label" );
						var btn_userDel = gen_list.getChild( insertIdx , "btn_userDel" );
						btn_userDel.setUserData("idx", insertIdx);
						tbx_label.setValue(drawData[idx][labelColId] || "&nbsp");
						valueColList.push(drawData[idx][valueColId]);
						insertIdx++;
						returnData.push(drawData[idx]);
						returnValueColData.push(drawData[idx][valueColId])
					}

					drawData = returnData;
				};

				udc_obj.deleteItem = function(idx) {
					if(com.util.isEmpty(idx)){
						idx = this.getUserData("idx");
					}
					var cnt = gen_list.getChildrenCount();
					if(cnt-1 <idx){
						return;
					}
					gen_list.removeChild(idx);
					valueColList =[];

					var itemList = udc_obj.getItemList();
					var delData = itemList[idx];
					var info ={
						"idx" : String(idx)
					}
					if(!com.util.isEmpty(delData)){
						info.label = delData[labelColId];
						info.value = delData[valueColId];
					}

					drawData.splice(idx,1);
					udc_obj.drawList();
					udc_obj.trigger("ondeleteItem",[info]);
				};

				udc_obj.deleteAllItem = function() {
					gen_list.removeAll();
					drawData =[]
					valueColList =[];
					returnValueColData =[];
					returnData =[];
				};

				udc_obj.addItem = function(label, value) {
					var obj = {}
					obj[labelColId] = label;
					obj[valueColId] = value;
					valueColList =[];
					drawData.push(obj);
					udc_obj.drawList();
				};

				udc_obj.setItemList = function(jsonData) {
					valueColList = [];
					drawData = jsonData;
					udc_obj.drawList();
				};

				udc_obj.getItemList = function() {
					return returnData;
				};

				udc_obj.getValue = function(delimiter) {
					var resultValue = returnValueColData.join(",");
					if(!com.util.isEmpty(delimiter) && typeof delimiter ==="string"){
						resultValue = valueColList.join(delimiter);
					}
					return resultValue;
				};

				udc_obj.setDisabled = function (isDisable) {
					var cnt = gen_list.getChildrenCount();
					for (var idx = 0; idx < cnt; idx++) {
						var grpListBox =gen_list.getChild(idx ,"grp_listBox");
						grpListBox.setDisabled(isDisable);
					}
				};

				udc_obj.setItemDisabled = function ( idx, isDisable) {
					var grpListBox =gen_list.getChild(idx ,"grp_listBox");
					if (!com.util.isEmpty(grpListBox)) {
						grpListBox.setDisabled(isDisable);
					}
				};

				udc_obj.getItemDisabled = function ( idx ) {
					var grpListBox = gen_list.getChild(idx ,"grp_listBox");
					if (!com.util.isEmpty(grpListBox)) {
						return grpListBox.getDisabled(isDisable);
					}
				};


				]]></script>
    		<script ev:event="onattributeChanged(type,value)" type="text/javascript"><![CDATA[ ]]></script>
    		<script ev:event="ondestroyed()" type="text/javascript"><![CDATA[ ]]></script>
    		<w2:generator style="" id="gen_list" class="search_people">
    			<xf:group tagname="li" toolTip="" style="" id="grp_listBox" class="">
    				<w2:textbox tagname="span" style="" id="tbx_label" label="목록레이블" class=""></w2:textbox>
    				<xf:trigger style="" id="btn_userDel" type="button" class="btn_userDel">
    					<xf:label><![CDATA[삭제]]></xf:label>
    					<script ev:event="onclick(e)" type="text/javascript"><![CDATA[
						var selectedIdx = this.getUserData("idx");
						udc_obj.deleteItem(selectedIdx);
    				 ]]></script>
    				</xf:trigger>
    			</xf:group>
    		</w2:generator>

    	</xf:group>
    </body>
</html>
